name: Test CodeQL Fixes

on:
  pull_request:
    branches: [ "main" ]
    paths:
      - 'scripts/**'
      - 'tests/**'
      - 'static/**'
      - 'src/**'
      - 'docusaurus.config.js'
      - 'package.json'
  workflow_dispatch:

jobs:
  test-codeql:
    name: Test CodeQL Fixes
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # Fetch full history to compare with base branch
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run local CodeQL checker
      continue-on-error: true
      run: |
        echo "Running local CodeQL checker..."
        echo "Note: This checker is stricter than GitHub CodeQL."
        echo "It may flag issues that GitHub CodeQL doesn't flag."
        echo "GitHub CodeQL is the authoritative source for security alerts."
        echo ""
        npm run check:codeql:simple
        echo ""
        echo "âœ… Check complete. Check GitHub CodeQL scanning page for actual alerts."

